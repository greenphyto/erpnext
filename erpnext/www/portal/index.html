{% from "erpnext/templates/includes/macros.html" import attribute_filter_section, field_filter_section,
discount_range_filters %}
{% extends "templates/web.html" %}

{% block title %}{{ _('Portal') }}{% endblock %}

{% block style %}
<style>
	.container {
		position: relative;
	}
	.content::before {
		position: absolute;
		content: "";
		background-image: url("/assets/erpnext/images/smartfm/greenphyto-building.jpg");
		background-size: cover;
		opacity: 0.7;
		top: 0px;
		right: 0px;
		bottom: 0px;
		left: 0px;
	}
	.title-container {
		position: relative;
		margin-right: 70px;
		padding-bottom: 80px;
		height: 80vh;
		display: flex;
		align-items: center;
		justify-content: flex-end;
		text-align: right;
	}
	.title {
		margin-bottom: 20px;
		font-weight: 700;
	}
	.btn {
		margin-bottom: 20px;
	}
	.hidden {
		display: none;
	}
</style>
{% endblock %}

{% block page_content %}
<div class="container">
	<div class="content">
		<!-- <img class="image" src="/assets/erpnext/images/smartfm/greenphyto-building.jpg" alt="Empty Cart"> -->
		<div class="title-container">
			<div>
				<h3 class="title">{{ _("Welcome to Smart FM") }}</h3>
				<div class="btn-smart-fm">
					<button class="btn btn-primary" onclick="location.href = '/smart-fm';">
						{{ _("Smart FM Checklists") }}
					</button>
				</div>
				<div class="btn-requests">
					<button class="btn btn-primary" onclick="location.href = '/requests';">
						{{ _("Requests from 3rd Party") }}
					</button>
				</div>
				<div class="btn-menu">
					<button class="btn btn-primary" onclick="location.href = '/menu';">
						{{ _("Menu") }}
					</button>
				</div>
			</div>
		</div>
	</div>
</div>

<script>
	frappe.ready(function () {
		if (frappe.session.user != 'Administrator') {
			frappe.call({
				method: "frappe.desk.reportview.get_list",
				args: {
					"doctype": "Has Role",
					"filters": {
						"parent": frappe.session.user,
						"parenttype": "User"
					},
					"fields": ["role"]
				},
				type: "GET",
				callback: function (r) {
					let roles = r.message.map(({ role }) => role);
					$('.btn-smart-fm').toggleClass('hidden', !roles.includes('Employee'));
					$('.btn-requests').toggleClass('hidden', !roles.includes('Employee') && !roles.includes('Vendor'));
					$('.btn-menu').toggleClass('hidden', !roles.includes('Employee'));
				},
			});
		}
	});
</script>
{% endblock %}